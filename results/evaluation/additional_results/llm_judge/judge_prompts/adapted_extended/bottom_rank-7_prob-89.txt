You are provided with a reference code function and a generated code function below.
Evaluate the code and return a score from 1-10 to rate the functional correctness of the generated function code compared to the reference code.
Return only the rating result.

**[Reference function code]**
static int hv_shield_init(const struct device* dev) {
  const struct hv_shield_config_t* config = dev->config;
  struct hv_shield_data_t* data = dev->data;

  int err = gpio_pin_configure_dt(&config->oe_gpio_spec, GPIO_OUTPUT_INACTIVE);
  if (err) {
    LOG_ERR("Error setting up Output enable pin (%d)", err);
    return err;
  }

  memset(&data->registers, 0, sizeof(data->registers));

  err = _hv_shield_update(dev);
  if (err) {
    LOG_ERR("Error writing registers (%d)", err);
    return err;
  }

  err = gpio_pin_set_dt(&config->oe_gpio_spec, 1);
  if (err) {
    LOG_ERR("Error setting enabling output (%d)", err);
  }

  return err;
}

**[Generated function code]**
static int hv_shield_init(const struct device* dev) {
  int ret;

  ret = gpio_request(dev->data->oe_gpio, "hv_shield_oe");
  if (ret < 0) {
    LOG_ERR("Failed to request OE GPIO %d\n", dev->data->oe_gpio);
    return ret;
  }

  ret = gpio_config_output(dev->data->oe_gpio, dev->data->oe_gpio_flags);
  if (ret < 0) {
    LOG_ERR("Failed to configure OE GPIO %d\n", dev->data->oe_gpio);
    gpio_free(dev->data->oe_gpio);
    return ret;
  }

  memset(dev->data->hw_reg, 0, sizeof(dev->data->hw_reg));

  ret = i2c_write(dev->data->i2c_bus, dev->data->hw_reg, sizeof(dev->data->hw_reg));
  if (ret < 0) {
    LOG_ERR("Failed to write to I2C register\n");
    gpio_free(dev->data->oe_gpio);
    return ret;
  }

  ret = gpio_set_value(dev->data->oe_gpio, 1);
  if (ret < 0) {
    LOG_ERR("Failed to set OE GPIO %d\n", dev->data->oe_gpio);
    gpio_free(dev->data->oe_gpio);
    return ret;
  }

  return 0;
}